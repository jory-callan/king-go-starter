项目结构概述
- cmd/: 命令行入口，包含server启动命令
- config/: 配置文件和配置管理
- docs/: 文档目录
- internal/
  - app/: 基础设施代码，提供全局依赖管理
  - common/: 通用常量
  - middleware/: 中间件
  - response/: 统一响应格式
  - router/: 路由模块，按业务划分
- pkg/
  - database/gormutil/: 泛型工具，提供base_repo和base_service
  - goutils/: 通用工具
  - http/: HTTP服务相关
  - jwt/: JWT认证
  - logx/: 日志工具

核心组件说明
1. gormutil泛型组件
- base_model.go: 基础模型，包含通用字段(ID、时间戳等)
- base_repo.go: 基础仓库层，提供CRUD和批量操作
- base_service.go: 基础服务层，嵌入base_repo
- base_handler.go: 基础控制层，快速测试用，生产建议自定义
- 使用限制: 只允许采纳repo和service层，handler层建议自定义

我已拥有泛型的 BaseRepo 和 BaseService，定义如下（无需重复实现，只需使用）：
// 泛型 Repo
type BaseRepo[T any] struct {
    db *gorm.DB
}
func (r *BaseRepo[T]) GetDB(ctx context.Context) *gorm.DB {
    return r.db.WithContext(ctx)
}
func (r *BaseRepo[T]) Create(ctx context.Context, entity *T) error { /* impl... */ }
func (r *BaseRepo[T]) GetByID(ctx context.Context, id string) (*T, error) { /* impl... */ }
func (r *BaseRepo[T]) Update(ctx context.Context, entity *T) error { /* impl... */ }
func (r *BaseRepo[T]) Delete(ctx context.Context, id string) error { /* impl... */ }
func (r *BaseRepo[T]) List(ctx context.Context, page, pageSize int) ([]T, int64, error) { /* 返回列表和总数 */ }
func (r *BaseRepo[T]) ListByCondition(ctx context.Context, conds interface{}, page, pageSize int) ([]T, int64, error) {}
// 泛型 Service (可选，如有)
type BaseService[T any] struct { repo *BaseRepo[T] }


2. app基础设施
- app.go: 全局应用实例，管理数据库、JWT、HTTP服务等依赖
- 依赖注入: 所有模块通过app实例获取依赖
- 统一初始化: 提供Must函数确保初始化成功

开发流程
1. 创建模型(Model)
- 在internal/router/[模块名]/下创建model.go
- 定义结构体，嵌入gorm.Model或gormutil.BaseModel
- 定义数据库字段和JSON标签

2. 实现服务层(Service)
- 创建service.go
- 定义Service结构体，包含必要依赖
- 实现业务逻辑方法
- 复杂业务可组合gormutil.BaseService

3. 实现控制层(Handler)
- 创建handler.go
- 定义请求结构体和验证规则
- 实现API处理方法，调用service层
- 使用统一响应格式(response包)

4. 注册路由(Router)
- 创建router.go
- 定义Module结构体，实现Name()和Register()方法
- 在Register()中自动迁移模型(AutoMigrate)
- 创建路由组，注册API端点
- 应用中间件(如JWT、限流)

5. 集成到应用
- 所有模块通过app.App实例获取依赖
- 模块注册时自动处理依赖注入

示例说明
1. 简单模块(如hello)
- 直接在router.go中定义路由和处理函数
- 适合简单API

2. 完整模块
- model.go: 定义User模型
- service.go: 实现注册、登录等业务逻辑
- handler.go: 处理HTTP请求和响应
- router.go: 注册路由和模型迁移

开发规范
- 模块命名: 使用小写单数
- 包结构: 按功能划分，高内聚低耦合
- 依赖管理: 通过app实例传递，避免全局变量
- 错误处理: 使用统一的错误响应格式
- 日志: 使用logx包记录日志

快速开始
1. 复制hello模块结构
2. 修改模型定义
3. 实现业务逻辑
4. 注册路由
5. 启动服务